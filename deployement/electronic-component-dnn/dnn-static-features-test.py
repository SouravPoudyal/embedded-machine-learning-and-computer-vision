import os, time
from edge_impulse_linux.runner import ImpulseRunner

# Setting
model_file = "modefied.eim"

# Copied features
features = [0.1546, 0.1684, 0.1770, 0.1770, 0.2129, 0.1983, 0.2142, 0.2142, 0.2142, 0.2214, 0.2335, 0.2539, 0.2407, 0.2407, 0.2618, 0.2407, 0.2389, 0.2334, 0.2404, 0.2407, 0.2407, 0.2407, 0.2407, 0.2142, 0.2174, 0.2142, 0.2159, 0.2195, 0.1719, 0.1770, 0.1699, 0.1770, 0.2063, 0.2105, 0.2128, 0.2142, 0.2321, 0.2407, 0.2512, 0.2326, 0.2407, 0.2407, 0.2577, 0.2736, 0.2355, 0.2392, 0.2407, 0.2407, 0.2384, 0.2407, 0.2297, 0.2329, 0.2142, 0.2194, 0.2222, 0.2182, 0.1770, 0.1770, 0.1796, 0.1964, 0.2142, 0.2142, 0.2201, 0.2385, 0.2374, 0.2407, 0.2366, 0.2770, 0.2533, 0.2407, 0.2449, 0.2618, 0.2618, 0.2526, 0.2776, 0.2395, 0.2406, 0.2407, 0.2407, 0.2421, 0.2407, 0.2173, 0.2142, 0.2239, 0.1864, 0.2182, 0.2142, 0.2182, 0.2182, 0.2142, 0.2151, 0.2326, 0.2326, 0.2407, 0.2558, 0.2710, 0.2710, 0.2407, 0.2366, 0.2512, 0.2802, 0.2802, 0.2795, 0.2677, 0.2618, 0.2512, 0.2407, 0.2603, 0.2315, 0.2161, 0.1924, 0.2122, 0.2147, 0.2142, 0.2301, 0.2148, 0.2407, 0.2313, 0.2313, 0.2326, 0.2405, 0.2407, 0.2512, 0.2618, 0.2542, 0.2331, 0.2407, 0.2533, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.2618, 0.2618, 0.2381, 0.2393, 0.2393, 0.2148, 0.2377, 0.2142, 0.2292, 0.2475, 0.2607, 0.2238, 0.2407, 0.2407, 0.2466, 0.2455, 0.2492, 0.2618, 0.2679, 0.2683, 0.2654, 0.2683, 0.2802, 0.2802, 0.2802, 0.2802, 0.2759, 0.2788, 0.2802, 0.2802, 0.2618, 0.2407, 0.2407, 0.2355, 0.2260, -0.4490, -0.3969, -0.2534, -0.3968, -0.6500, 0.1908, 0.2600, 0.2618, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.3145, 0.4203, 0.2703, 0.0612, -0.1370, -0.2010, -0.2512, -0.0489, 0.2532, 0.2989, 0.2618, 0.2407, 0.2410, 0.2326, 0.2205, -0.4644, -0.3459, -0.1480, -0.0916, -0.5068, -0.6933, 0.3538, 0.2802, 0.2785, 0.3006, 0.3377, 0.2666, -0.0023, -0.3148, -0.4392, -0.4127, -0.4129, -0.4412, -0.5713, -0.4998, -0.3575, -0.3245, -0.0481, 0.2615, 0.2554, 0.2407, 0.2343, 0.2343, -0.4223, -0.4585, -0.5037, -0.4792, -0.4420, -0.7091, -0.4939, 0.1036, 0.0422, -0.3927, -0.4307, -0.4901, -0.4594, -0.4617, -0.5544, -0.4783, -0.4021, -0.4528, -0.3848, -0.3903, -0.3538, -0.3379, -0.3662, 0.1901, 0.2743, 0.2741, 0.2661, 0.2542, -0.0922, 0.0128, 0.0630, 0.0621, -0.3388, -0.4814, -0.7759, -0.7355, -0.6980, -0.6982, -0.7440, -0.6158, -0.4946, -0.4537, -0.5085, -0.5669, -0.4148, -0.5177, -0.3870, -0.4826, -0.3174, -0.3303, -0.3354, -0.4204, 0.2806, 0.2802, 0.2736, 0.2618, 0.2315, 0.2315, 0.2407, 0.2584, 0.0483, -0.4574, -0.2673, 0.1154, 0.2379, 0.2410, 0.1259, -0.2581, -0.5026, -0.4723, -0.4220, -0.4584, -0.4016, -0.5085, -0.4779, -0.3466, -0.3300, -0.3166, -0.3354, -0.4025, 0.2599, 0.2802, 0.2802, 0.2802, 0.2605, 0.2407, 0.2407, 0.2401, 0.1945, -0.0548, -0.4670, -0.5119, -0.5348, -0.5448, -0.5744, -0.6259, -0.4960, -0.4547, -0.5171, -0.4617, -0.3939, -0.4189, -0.4051, -0.4002, -0.3240, -0.3166, -0.3472, -0.3278, 0.2140, 0.2802, 0.2802, 0.2802, 0.2407, 0.2434, 0.2288, 0.2407, 0.2407, 0.2794, 0.2221, 0.1685, 0.1086, 0.1066, -0.0357, -0.3871, -0.4877, -0.4868, -0.4724, -0.5085, -0.4467, -0.3852, -0.3882, -0.3332, -0.3283, -0.3166, -0.3538, -0.3171, 0.1738, 0.2977, 0.2802, 0.2802, 0.2407, 0.2407, 0.2389, 0.2407, 0.2407, 0.2551, 0.2762, 0.2762, 0.2762, 0.2524, 0.2051, -0.1855, -0.4700, -0.4678, -0.5973, -0.4274, -0.3812, -0.4392, -0.3920, -0.3676, -0.3086, -0.2716, -0.3524, -0.3452, 0.1465, 0.2973, 0.2802, 0.2802, 0.2389, 0.2389, 0.2389, 0.2407, 0.2654, 0.2802, 0.2817, 0.2814, 0.2817, 0.2802, 0.1993, -0.2555, -0.4473, -0.4160, -0.5355, -0.4782, -0.3752, -0.3531, -0.2820, -0.1479, -0.2779, -0.2339, -0.3486, -0.3349, 0.1457, 0.2976, 0.2802, 0.2802, 0.2208, 0.2317, 0.2407, 0.2512, 0.2802, 0.2802, 0.2822, 0.2802, 0.2802, 0.2802, 0.2098, -0.4627, -0.4234, -0.3885, -0.5412, -0.5036, -0.3787, -0.3560, 0.0467, 0.2796, -0.0575, -0.3235, -0.3538, -0.3862, 0.1612, 0.2802, 0.2802, 0.2802, 0.2217, 0.2236, 0.2437, 0.2802, 0.2802, 0.2802, 0.2808, 0.3476, 0.3937, 0.3147, -0.3701, -0.4327, -0.4081, -0.3966, -0.4100, -0.4066, -0.4115, -0.3867, -0.3977, -0.4500, -0.3534, -0.3771, -0.3945, -0.4194, 0.1972, 0.2973, 0.2986, 0.2805, 0.2366, 0.2378, 0.2802, 0.2782, 0.2341, -0.2336, -0.2165, -0.4384, -0.4080, -0.4117, -0.4280, -0.4413, -0.4419, -0.4419, -0.4327, -0.4419, -0.4434, -0.4525, -0.4531, -0.4419, -0.4327, -0.4308, -0.4072, -0.4536, 0.2508, 0.2973, 0.2953, 0.2821, 0.2405, 0.2378, 0.2392, 0.1155, 0.6595, 0.6511, -0.6951, -0.5697, -0.5009, -0.5230, -0.5242, -0.5084, -0.5255, -0.5268, -0.5439, -0.5439, -0.5442, -0.5456, -0.5431, -0.5268, -0.5159, -0.4786, -0.4447, -0.1965, 0.2564, 0.2986, 0.2981, 0.2802, 0.2407, 0.2359, 0.3182, -0.5725, -0.3858, -0.1846, -0.0332, -0.1409, -0.2672, -0.5671, -0.5883, -0.5903, -0.5979, -0.5927, -0.5860, -0.5945, -0.5980, -0.5860, -0.5980, -0.5836, -0.5598, -0.5176, -0.4274, 0.0742, 0.2894, 0.2986, 0.2878, 0.2802, 0.3593, 0.0894, -0.3819, 0.0316, -0.3574, -0.6598, -0.6538, -0.6836, -0.7236, -0.8193, -0.7810, -0.7559, -0.7870, -0.6727, -0.5339, -0.5127, -0.5087, -0.4926, -0.4828, -0.4684, -0.4583, -0.5218, -0.3059, 0.2053, 0.2986, 0.2986, 0.2802, 0.2802, -0.2767, -0.1528, -0.3318, -0.4214, -0.5837, -0.1177, 0.1272, 0.1187, 0.0491, -0.0851, -0.2565, -0.4049, -0.5494, -0.6841, -0.7168, -0.7821, -0.7809, -0.7955, -0.7792, -0.7635, -0.6439, -0.1851, 0.1956, 0.2949, 0.3100, 0.2946, 0.2946, 0.2802, -0.4886, -0.3816, -0.3987, -0.5474, -0.1711, 0.1850, 0.2052, 0.2037, 0.2113, 0.2373, 0.2188, 0.1914, 0.1685, 0.1014, 0.0699, 0.0466, 0.0333, 0.0222, 0.0388, 0.0861, 0.1850, 0.2415, 0.2844, 0.2987, 0.2987, 0.2802, 0.2802, 0.2802, -0.8127, -0.8041, -0.6541, -0.1601, 0.1938, 0.2169, 0.2146, 0.2142, 0.2142, 0.2142, 0.2313, 0.2326, 0.2326, 0.2418, 0.2230, 0.2340, 0.2378, 0.2606, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, 0.2802, -0.0643, 0.0053, 0.1193, 0.1798, 0.2129, 0.2142, 0.2142, 0.2142, 0.2142, 0.2050, 0.2142, 0.2227, 0.2326, 0.2326, 0.2326, 0.2472, 0.2802, 0.2710, 0.2802, 0.2802, 0.2710, 0.2637, 0.2802, 0.2802, 0.2802, 0.2716, 0.2710, 0.2710, 0.1543, 0.1766, 0.1757, 0.1770, 0.1958, 0.1958, 0.2142, 0.1961, 0.1971, 0.1958, 0.2142, 0.2142, 0.2155, 0.2207, 0.2170, 0.2157, 0.2170, 0.2256, 0.2347, 0.2435, 0.2422, 0.2455, 0.2618, 0.2422, 0.2789, 0.2757, 0.2548, 0.2407, 0.1515, 0.1515, 0.1515, 0.1515, 0.1625, 0.1754, 0.1805, 0.1825, 0.1882, 0.1819, 0.1819, 0.1819, 0.1891, 0.1943, 0.2035, 0.2142, 0.2142, 0.2142, 0.2142, 0.2208, 0.2355, 0.2355, 0.2462, 0.2396, 0.2142, 0.2142, 0.2142, 0.2142, 0.1330, 0.1356, 0.1504, 0.1370, 0.1515, 0.1515, 0.1515, 0.1515, 0.1554, 0.1554, 0.1534, 0.1688, 0.1554, 0.1585, 0.1871, 0.1799, 0.1846, 0.1902, 0.1997, 0.1997, 0.1997, 0.1997, 0.2153, 0.1997, 0.1978, 0.1997, 0.2142, 0.2142]

#
print()
print("---Static Features Inference Test---")


# loading files relative to this program instead
dir_path = os.path.dirname(os.path.realpath(__file__))
model_path = os.path.join(dir_path, model_file)

# Loading the model file
runner = ImpulseRunner(model_path)

# Perfrom inference and print results
try:

    # Print model information
    model_info = runner.init()
    print("Model name:", model_info['project']['name'])
    print("Model owner:", model_info['project']['owner'])

    # Perform inference and time how long it takes
    start_time = time.time_ns()
    res = runner.classify(features)
    elapsed_time = time.time_ns() - start_time
    
    # Display predictions
    print("Predictions:")
    predictions = res['result']['classification']
    for p in predictions:
        print("  " + p + ": " + str(predictions[p]))
    
    # Print out how long it took to perform inference
    print("Inference time:", (elapsed_time / 1000000), "ms")
    
    # Print out the timing breakdown
    print("Timing breakdown:", res['timing'])

finally:
    if (runner):
        runner.stop()
    print()